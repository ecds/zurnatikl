{% extends 'site_base.html' %}
{# display details for a single issue in a journal #}
{% load journal_extras %}

{% block content %}
<ol class="breadcrumb">
  <li><a href="{% url 'journals:list' %}">Journals</a></li>
  <li><a href="{% url 'journals:journal' issue.journal.slug %}">{{ issue.journal.title }}</a></li>
  <li class="active">{{ issue.label }}</li>
</ol>

<h2><a href="{% url 'journals:journal' issue.journal.slug %}">{{ issue.journal.title }}</a></h2>

<div class="j-issues">

<h3>{{ issue.label }} ({{ issue.date }})</h3>

{# editors #}
{% with editors=issue.editors.all %}
{% if editors %}
{% for editor in editors %}
 <a href="{{editor.get_absolute_url}}">{{editor.firstname_lastname}}</a>{% if editors.count == 1 %}{% elif forloop.counter == editors.count %}{% else %},{% endif %}
  {% endfor %}
{% endif %}
{% endwith %}

{# contributing editors #}
{% with editors=issue.contributing_editors.all %}
{% if editors %}
{% for editor in editors %}
 <a href="{{editor.get_absolute_url}}">{{editor.firstname_lastname}}</a>{% if editors.count == 1 %}{% elif forloop.counter == editors.count %}{% else %},{% endif %}
  {% endfor %}
{% endif %}
{% endwith %}

{# publication address #}
{% if issue.publication_address %}
<p>Published at {{ issue.publication_address.display_label }}</p>
{% endif %}

{# print address #}
{% if issue.print_address %}
<p>Printed at {{ issue.print_address.display_label }}</p>
{% endif %}

{# price #}
{% if issue.price %}
<p>Price per issue: ${{ issue.price }}</p>
{% endif %}

<div class="toc">
    <div class="toc-header">
      <span>Start Page</span>
      <span>End Page</span>
      <span>Contents</span>
    </div>
{% for item in issue.item_set.all %}
  <ul>
    <li>{{ item.start_page }}</li>
    <li>{{ item.end_page }}</li>
    <li>{{ item.title }}{% if item.creators.count or item.translators.count %},{% endif %}
      {% if item.creators.count %}
      {% for creator in item.creators.all %}
 <a href="{{creator.get_absolute_url}}">{{creator.firstname_lastname}}</a>{% if item.creators.all.count == 1 %}{% elif forloop.counter == item.creators.all.count %}{% else %},{% endif %}
  {% endfor %}
     {% endif %}  
      {% if item.translators.count %}
       trans. {{ item.translators.all|readable_list:'firstname_lastname' }}
      {% endif %}
    </li>
  </ul>

{% endfor %}
</div>
</div> {# j-issues #}

{# FIXME: layout doesn't work properly without an image here #}
  <div class="j-image">
{% comment %}   <picture>
      <source srcset="beatitude-issue-9-img.png" media="(max-width: 320px)" class="img-responsive">
      <source srcset="beatitude-issue-9-img.png" class="img-responsive">
      <img srcset="beatitude-issue-9-img.png" alt="My default image" class="img-responsive">
    </picture>{% endcomment %}
  </div>


<nav>
  <ul class="pager">
    {% if issue.previous_issue %}
    <li class="previous"><a href="{% url 'journals:issue' issue.journal.slug issue.previous_issue.id %}"><span aria-hidden="true">&larr;</span> {{ issue.previous_issue.label }}</a></li>
    {% else %}
    <li class="previous disabled"><a href="#"><span aria-hidden="true">&larr;</span></a></li>
    {% endif %}
    {% if issue.next_issue %}
    <li class="next"><a href="{% url 'journals:issue' issue.journal.slug issue.next_issue.id %}">{{ issue.next_issue.label }} <span aria-hidden="true">&rarr;</span></a></li>
    {% else %}
    <li class="next disabled"><a href="#"><span aria-hidden="true">&rarr;</span></a></li>
    {% endif %}
  </ul>
</nav>

</div>
{% endblock %}

